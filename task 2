import pandas as pd
import os


def main():
    os.makedirs("outputs", exist_ok=True)

    df = pd.read_csv("data/all_repository.csv")

    task2 = df[[
        "id",
        "language",
        "stars",
        "url"
    ]].rename(columns={
        "id": "REPOID",
        "language": "LANG",
        "stars": "STARS",
        "url": "REPOURL"
    })

    task2.to_csv("outputs/task2_output.csv", index=False)
    print("Task-2: outputs/task2_output.csv written successfully.")


if __name__ == "__main__":
    main()
